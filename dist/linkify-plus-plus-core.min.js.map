{"version":3,"file":"linkify-plus-plus-core.min.js","sources":["../lib/url-matcher.js","../node_modules/event-lite/event-lite.js","../lib/linkifier.js"],"sourcesContent":["var tlds = require(\"./tlds.json\"),\r\n\tRE = {\r\n\t\tPROTOCOL: \"([a-z][-a-z*]+://)?\",\r\n\t\tUSER: \"(?:([\\\\w:.+-]+)@)?\",\r\n\t\tDOMAIN_UNI: `([a-z0-9-.\\\\u00A0-\\\\uFFFF]+\\\\.[a-z0-9-${tlds.chars}]{1,${tlds.maxLength}})`,\r\n\t\tDOMAIN: `([a-z0-9-.]+\\\\.[a-z0-9-]{1,${tlds.maxLength}})`,\r\n\t\tPORT: \"(:\\\\d+\\\\b)?\",\r\n\t\tPATH_UNI: \"([/?#]\\\\S*)?\",\r\n\t\tPATH: \"([/?#][\\\\w-.~!$&*+;=:@%/?#(),'\\\\[\\\\]]*)?\"\r\n\t},\r\n\tTLD_TABLE = tlds.table;\r\n\r\nfunction regexEscape(text) {\r\n\treturn text.replace(/[[\\]\\\\^-]/g, \"\\\\$&\");\r\n}\r\n\r\nfunction buildRegex({\r\n\tunicode = false, customRules = [], standalone = false,\r\n\tboundaryLeft, boundaryRight\r\n}) {\r\n\tvar pattern = RE.PROTOCOL + RE.USER;\r\n\t\r\n\tif (unicode) {\r\n\t\tpattern += RE.DOMAIN_UNI + RE.PORT + RE.PATH_UNI;\r\n\t} else {\r\n\t\tpattern += RE.DOMAIN + RE.PORT + RE.PATH;\r\n\t}\r\n\t\r\n\tif (customRules.length) {\r\n\t\tpattern = \"(?:(\" + customRules.join(\"|\") + \")|\" + pattern + \")\";\r\n\t} else {\r\n\t\tpattern = \"()\" + pattern;\r\n\t}\r\n\t\r\n\tvar prefix, suffix, invalidSuffix;\r\n\tif (standalone) {\r\n\t\tif (boundaryLeft) {\r\n\t\t\tprefix = \"((?:^|\\\\s)[\" + regexEscape(boundaryLeft) + \"]*?)\";\r\n\t\t} else {\r\n\t\t\tprefix = \"(^|\\\\s)\";\r\n\t\t}\r\n\t\tif (boundaryRight) {\r\n\t\t\tsuffix = \"([\" + regexEscape(boundaryRight) + \"]*(?:$|\\\\s))\";\r\n\t\t} else {\r\n\t\t\tsuffix = \"($|\\\\s)\";\r\n\t\t}\r\n\t\tinvalidSuffix = \"[^\\\\s\" + regexEscape(boundaryRight) + \"]\";\r\n\t} else {\r\n\t\tprefix = \"(^|\\\\b|_)\";\r\n\t\tsuffix = \"()\";\r\n\t}\r\n\t\r\n\tpattern = prefix + pattern + suffix;\r\n\t\r\n\treturn {\r\n\t\turl: new RegExp(pattern, \"igm\"),\r\n\t\tinvalidSuffix: invalidSuffix && new RegExp(invalidSuffix),\r\n\t\tmustache: /\\{\\{[\\s\\S]+?\\}\\}/g\r\n\t};\r\n}\r\n\r\nfunction pathStrip(m, re, repl) {\r\n\tvar s = m.path.replace(re, repl);\r\n\r\n\tif (s == m.path) return;\r\n\t\r\n\tm.end -= m.path.length - s.length;\r\n\tm.suffix = m.path.slice(s.length) + m.suffix;\r\n\tm.path = s;\r\n}\r\n\r\nfunction pathStripQuote(m, c) {\r\n\tvar i = 0, s = m.path, end, pos = 0;\r\n\t\r\n\tif (!s.endsWith(c)) return;\r\n\t\r\n\twhile ((pos = s.indexOf(c, pos)) >= 0) {\r\n\t\tif (i % 2) {\r\n\t\t\tend = null;\r\n\t\t} else {\r\n\t\t\tend = pos;\r\n\t\t}\r\n\t\tpos++;\r\n\t\ti++;\r\n\t}\r\n\t\r\n\tif (!end) return;\r\n\t\r\n\tm.end -= s.length - end;\r\n\tm.path = s.slice(0, end);\r\n\tm.suffix = s.slice(end) + m.suffix;\r\n}\r\n\r\nfunction pathStripBrace(m, left, right) {\r\n\tvar str = m.path,\r\n\t\tre = new RegExp(\"[\\\\\" + left + \"\\\\\" + right + \"]\", \"g\"),\r\n\t\tmatch, count = 0, end;\r\n\r\n\t// Match loop\r\n\twhile ((match = re.exec(str))) {\r\n\t\tif (count % 2 == 0) {\r\n\t\t\tend = match.index;\r\n\t\t\tif (match[0] == right) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (match[0] == left) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tcount++;\r\n\t}\r\n\r\n\tif (!match && count % 2 == 0) {\r\n\t\treturn;\r\n\t}\r\n\t\r\n\tm.end -= m.path.length - end;\r\n\tm.path = str.slice(0, end);\r\n\tm.suffix = str.slice(end) + m.suffix;\r\n}\r\n\r\nfunction isIP(s) {\r\n\tvar m, i;\r\n\tif (!(m = s.match(/^(\\d{1,3})\\.(\\d{1,3})\\.(\\d{1,3})\\.(\\d{1,3})$/))) {\r\n\t\treturn false;\r\n\t}\r\n\tfor (i = 1; i < m.length; i++) {\r\n\t\tif (+m[i] > 255 || (m[i].length > 1 && m[i][0] == \"0\")) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction inTLDS(domain) {\r\n\tvar match = domain.match(/\\.([^.]+)$/);\r\n\tif (!match) {\r\n\t\treturn false;\r\n\t}\r\n\tvar key = match[1].toLowerCase();\r\n  // eslint-disable-next-line no-prototype-builtins\r\n\treturn TLD_TABLE.hasOwnProperty(key);\r\n}\r\n\r\nclass UrlMatcher {\r\n\tconstructor(options = {}) {\r\n\t\tthis.options = options;\r\n\t\tthis.regex = buildRegex(options);\r\n\t}\r\n\t\r\n\t*match(text) {\r\n\t\tvar {\r\n\t\t\t\tfuzzyIp = true,\r\n\t\t\t\tignoreMustache = false,\r\n        mail = true\r\n\t\t\t} = this.options,\r\n\t\t\t{\r\n\t\t\t\turl,\r\n\t\t\t\tinvalidSuffix,\r\n\t\t\t\tmustache\r\n\t\t\t} = this.regex,\r\n\t\t\turlLastIndex, mustacheLastIndex;\r\n\t\t\t\r\n\t\tmustache.lastIndex = 0;\r\n\t\turl.lastIndex = 0;\r\n\t\t\r\n\t\tvar mustacheMatch, mustacheRange;\r\n\t\tif (ignoreMustache) {\r\n\t\t\tmustacheMatch = mustache.exec(text);\r\n\t\t\tif (mustacheMatch) {\r\n\t\t\t\tmustacheRange = {\r\n\t\t\t\t\tstart: mustacheMatch.index,\r\n\t\t\t\t\tend: mustache.lastIndex\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tvar urlMatch;\r\n\t\twhile ((urlMatch = url.exec(text))) {\r\n      const result = {\r\n        start: 0,\r\n        end: 0,\r\n        \r\n        text: \"\",\r\n        url: \"\",\r\n        \r\n        prefix: urlMatch[1],\r\n        custom: urlMatch[2],\r\n        protocol: urlMatch[3],\r\n        auth: urlMatch[4] || \"\",\r\n        domain: urlMatch[5],\r\n        port: urlMatch[6] || \"\",\r\n        path: urlMatch[7] || \"\",\r\n        suffix: urlMatch[8]\r\n      };\r\n      \r\n      if (result.custom) {\r\n        result.start = urlMatch.index;\r\n        result.end = url.lastIndex;\r\n        result.text = result.url = urlMatch[0];\r\n\t\t\t} else {\r\n        \r\n        result.start = urlMatch.index + result.prefix.length;\r\n        result.end = url.lastIndex - result.suffix.length;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (mustacheRange && mustacheRange.end <= result.start) {\r\n\t\t\t\tmustacheMatch = mustache.exec(text);\r\n\t\t\t\tif (mustacheMatch) {\r\n\t\t\t\t\tmustacheRange.start = mustacheMatch.index;\r\n\t\t\t\t\tmustacheRange.end = mustache.lastIndex;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tmustacheRange = null;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// ignore urls inside mustache pair\r\n\t\t\tif (mustacheRange && result.start < mustacheRange.end && result.end >= mustacheRange.start) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (!result.custom) {\r\n\t\t\t\t// adjust path and suffix\r\n\t\t\t\tif (result.path) {\r\n\t\t\t\t\t// Strip BBCode\r\n\t\t\t\t\tpathStrip(result, /\\[\\/?(b|i|u|url|img|quote|code|size|color)\\].*/i, \"\");\r\n\t\t\t\t\t\r\n\t\t\t\t\t// Strip braces\r\n\t\t\t\t\tpathStripBrace(result, \"(\", \")\");\r\n\t\t\t\t\tpathStripBrace(result, \"[\", \"]\");\r\n\t\t\t\t\tpathStripBrace(result, \"{\", \"}\");\r\n\t\t\t\t\t\r\n\t\t\t\t\t// Strip quotes\r\n\t\t\t\t\tpathStripQuote(result, \"'\");\r\n\t\t\t\t\tpathStripQuote(result, '\"');\r\n\t\t\t\t\t\r\n\t\t\t\t\t// Remove trailing \".,?\"\r\n\t\t\t\t\tpathStrip(result, /(^|[^-_])[.,?]+$/, \"$1\");\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// check suffix\r\n\t\t\t\tif (invalidSuffix && invalidSuffix.test(result.suffix)) {\r\n\t\t\t\t\tif (/\\s$/.test(result.suffix)) {\r\n\t\t\t\t\t\turl.lastIndex--;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n        \r\n        // ignore fuzzy ip\r\n\t\t\t\tif (!fuzzyIp && isIP(result.domain) &&\r\n            !result.protocol && !result.auth && !result.path) {\r\n          continue;\r\n        }\r\n        \r\n\t\t\t\t// mailto protocol\r\n\t\t\t\tif (!result.protocol && result.auth) {\r\n\t\t\t\t\tvar matchMail = result.auth.match(/^mailto:(.+)/);\r\n\t\t\t\t\tif (matchMail) {\r\n\t\t\t\t\t\tresult.protocol = \"mailto:\";\r\n\t\t\t\t\t\tresult.auth = matchMail[1];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// http alias\r\n\t\t\t\tif (result.protocol && result.protocol.match(/^(hxxp|h\\*\\*p|ttp)/)) {\r\n\t\t\t\t\tresult.protocol = \"http://\";\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// guess protocol\r\n\t\t\t\tif (!result.protocol) {\r\n\t\t\t\t\tvar domainMatch;\r\n\t\t\t\t\tif ((domainMatch = result.domain.match(/^(ftp|irc)/))) {\r\n\t\t\t\t\t\tresult.protocol = domainMatch[0] + \"://\";\r\n\t\t\t\t\t} else if (result.domain.match(/^(www|web)/)) {\r\n\t\t\t\t\t\tresult.protocol = \"http://\";\r\n\t\t\t\t\t} else if (result.auth && result.auth.indexOf(\":\") < 0 && !result.path) {\r\n\t\t\t\t\t\tresult.protocol = \"mailto:\";\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tresult.protocol = \"http://\";\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n        \r\n        // ignore mail\r\n        if (!mail && result.protocol === \"mailto:\") {\r\n          continue;\r\n        }\r\n        \r\n\t\t\t\t// verify domain\r\n        if (!isIP(result.domain)) {\r\n          if (/^(http|https|mailto)/.test(result.protocol) && !inTLDS(result.domain)) {\r\n            continue;\r\n          }\r\n          \r\n          const invalidLabel = getInvalidLabel(result.domain);\r\n          if (invalidLabel) {\r\n            url.lastIndex = invalidLabel.index + 1;\r\n            continue;\r\n          }\r\n        }\r\n\r\n\t\t\t\t// Create URL\r\n\t\t\t\tresult.url = result.protocol + (result.auth && result.auth + \"@\") + result.domain + result.port + result.path;\r\n\t\t\t\tresult.text = text.slice(result.start, result.end);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// since regex is shared with other parse generators, cache lastIndex position and restore later\r\n\t\t\tmustacheLastIndex = mustache.lastIndex;\r\n\t\t\turlLastIndex = url.lastIndex;\r\n\t\t\t\r\n\t\t\tyield result;\r\n\t\t\t\r\n\t\t\turl.lastIndex = urlLastIndex;\r\n\t\t\tmustache.lastIndex = mustacheLastIndex;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction getInvalidLabel(domain) {\r\n  // https://tools.ietf.org/html/rfc1035\r\n  let index = 0;\r\n  const parts = domain.split(\".\");\r\n  for (const part of parts) {\r\n    if (\r\n      !part ||\r\n      part.length === 1 && /[\\d-]/.test(part) ||\r\n      part.length > 1 && !/^[^\\d-].*[^-]$/.test(part)\r\n    ) {\r\n      return {\r\n        index,\r\n        value: part\r\n      };\r\n    }\r\n    index += part.length + 1;\r\n  }\r\n}\r\n\r\nmodule.exports = {\r\n\tUrlMatcher\r\n};\r\n","/**\n * event-lite.js - Light-weight EventEmitter (less than 1KB when gzipped)\n *\n * @copyright Yusuke Kawasaki\n * @license MIT\n * @constructor\n * @see https://github.com/kawanet/event-lite\n * @see http://kawanet.github.io/event-lite/EventLite.html\n * @example\n * var EventLite = require(\"event-lite\");\n *\n * function MyClass() {...}             // your class\n *\n * EventLite.mixin(MyClass.prototype);  // import event methods\n *\n * var obj = new MyClass();\n * obj.on(\"foo\", function() {...});     // add event listener\n * obj.once(\"bar\", function() {...});   // add one-time event listener\n * obj.emit(\"foo\");                     // dispatch event\n * obj.emit(\"bar\");                     // dispatch another event\n * obj.off(\"foo\");                      // remove event listener\n */\n\nfunction EventLite() {\n  if (!(this instanceof EventLite)) return new EventLite();\n}\n\n(function(EventLite) {\n  // export the class for node.js\n  if (\"undefined\" !== typeof module) module.exports = EventLite;\n\n  // property name to hold listeners\n  var LISTENERS = \"listeners\";\n\n  // methods to export\n  var methods = {\n    on: on,\n    once: once,\n    off: off,\n    emit: emit\n  };\n\n  // mixin to self\n  mixin(EventLite.prototype);\n\n  // export mixin function\n  EventLite.mixin = mixin;\n\n  /**\n   * Import on(), once(), off() and emit() methods into target object.\n   *\n   * @function EventLite.mixin\n   * @param target {Prototype}\n   */\n\n  function mixin(target) {\n    for (var key in methods) {\n      target[key] = methods[key];\n    }\n    return target;\n  }\n\n  /**\n   * Add an event listener.\n   *\n   * @function EventLite.prototype.on\n   * @param type {string}\n   * @param func {Function}\n   * @returns {EventLite} Self for method chaining\n   */\n\n  function on(type, func) {\n    getListeners(this, type).push(func);\n    return this;\n  }\n\n  /**\n   * Add one-time event listener.\n   *\n   * @function EventLite.prototype.once\n   * @param type {string}\n   * @param func {Function}\n   * @returns {EventLite} Self for method chaining\n   */\n\n  function once(type, func) {\n    var that = this;\n    wrap.originalListener = func;\n    getListeners(that, type).push(wrap);\n    return that;\n\n    function wrap() {\n      off.call(that, type, wrap);\n      func.apply(this, arguments);\n    }\n  }\n\n  /**\n   * Remove an event listener.\n   *\n   * @function EventLite.prototype.off\n   * @param [type] {string}\n   * @param [func] {Function}\n   * @returns {EventLite} Self for method chaining\n   */\n\n  function off(type, func) {\n    var that = this;\n    var listners;\n    if (!arguments.length) {\n      delete that[LISTENERS];\n    } else if (!func) {\n      listners = that[LISTENERS];\n      if (listners) {\n        delete listners[type];\n        if (!Object.keys(listners).length) return off.call(that);\n      }\n    } else {\n      listners = getListeners(that, type, true);\n      if (listners) {\n        listners = listners.filter(ne);\n        if (!listners.length) return off.call(that, type);\n        that[LISTENERS][type] = listners;\n      }\n    }\n    return that;\n\n    function ne(test) {\n      return test !== func && test.originalListener !== func;\n    }\n  }\n\n  /**\n   * Dispatch (trigger) an event.\n   *\n   * @function EventLite.prototype.emit\n   * @param type {string}\n   * @param [value] {*}\n   * @returns {boolean} True when a listener received the event\n   */\n\n  function emit(type, value) {\n    var that = this;\n    var listeners = getListeners(that, type, true);\n    if (!listeners) return false;\n    var arglen = arguments.length;\n    if (arglen === 1) {\n      listeners.forEach(zeroarg);\n    } else if (arglen === 2) {\n      listeners.forEach(onearg);\n    } else {\n      var args = Array.prototype.slice.call(arguments, 1);\n      listeners.forEach(moreargs);\n    }\n    return !!listeners.length;\n\n    function zeroarg(func) {\n      func.call(that);\n    }\n\n    function onearg(func) {\n      func.call(that, value);\n    }\n\n    function moreargs(func) {\n      func.apply(that, args);\n    }\n  }\n\n  /**\n   * @ignore\n   */\n\n  function getListeners(that, type, readonly) {\n    if (readonly && !that[LISTENERS]) return;\n    var listeners = that[LISTENERS] || (that[LISTENERS] = {});\n    return listeners[type] || (listeners[type] = []);\n  }\n\n})(EventLite);\n","/* eslint-env browser */\r\n\r\nvar Events = require(\"event-lite\");\r\n\r\nvar INVALID_TAGS = {\r\n\ta: true,\r\n\tnoscript: true,\r\n\toption: true,\r\n\tscript: true,\r\n\tstyle: true,\r\n\ttextarea: true,\r\n\tsvg: true,\r\n\tcanvas: true,\r\n\tbutton: true,\r\n\tselect: true,\r\n\ttemplate: true,\r\n\tmeter: true,\r\n\tprogress: true,\r\n\tmath: true,\r\n\ttime: true\r\n};\r\n\r\nclass Pos {\r\n\tconstructor(container, offset, i = 0) {\r\n\t\tthis.container = container;\r\n\t\tthis.offset = offset;\r\n\t\tthis.i = i;\r\n\t}\r\n\t\r\n\tadd(change) {\r\n\t\tvar cont = this.container,\r\n\t\t\toffset = this.offset;\r\n\r\n\t\tthis.i += change;\r\n\t\t\r\n\t\t// If the container is #text.parentNode\r\n\t\tif (cont.childNodes.length) {\r\n\t\t\tcont = cont.childNodes[offset];\r\n\t\t\toffset = 0;\r\n\t\t}\r\n\r\n\t\t// If the container is #text\r\n\t\twhile (cont) {\r\n\t\t\tif (cont.nodeType == 3) {\r\n\t\t\t\tif (!cont.LEN) {\r\n\t\t\t\t\tcont.LEN = cont.nodeValue.length;\r\n\t\t\t\t}\r\n\t\t\t\tif (offset + change <= cont.LEN) {\r\n\t\t\t\t\tthis.container = cont;\r\n\t\t\t\t\tthis.offset = offset + change;\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tchange = offset + change - cont.LEN;\r\n\t\t\t\toffset = 0;\r\n\t\t\t}\r\n\t\t\tcont = cont.nextSibling;\r\n\t\t}\r\n\t}\r\n\t\r\n\tmoveTo(offset) {\r\n\t\tthis.add(offset - this.i);\r\n\t}\r\n}\r\n\r\nfunction cloneContents(range) {\r\n\tif (range.startContainer == range.endContainer) {\r\n\t\treturn document.createTextNode(range.toString());\r\n\t}\r\n\treturn range.cloneContents();\r\n}\r\n\r\nvar DEFAULT_OPTIONS = {\r\n\tmaxRunTime: 100,\r\n\ttimeout: 10000,\r\n\tnewTab: true,\r\n\tnoOpener: true,\r\n\tembedImage: true\r\n};\r\n\r\nclass Linkifier extends Events {\r\n\tconstructor(root, options = {}) {\r\n\t\tsuper();\r\n\t\tif (!(root instanceof Node)) {\r\n\t\t\toptions = root;\r\n\t\t\troot = options.root;\r\n\t\t}\r\n\t\tthis.root = root;\r\n\t\tthis.options = Object.assign({}, DEFAULT_OPTIONS, options);\r\n\t\tthis.aborted = false;\r\n\t}\r\n\tstart() {\r\n\t\tvar time = Date.now,\r\n\t\t\tstartTime = time(),\r\n\t\t\tchunks = this.generateChunks();\r\n\t\t\t\r\n\t\tvar next = () => {\r\n\t\t\tif (this.aborted) {\r\n\t\t\t\tthis.emit(\"error\", new Error(\"Aborted\"));\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar chunkStart = time(),\r\n\t\t\t\tnow;\r\n\t\t\t\t\r\n\t\t\tdo {\r\n\t\t\t\tif (chunks.next().done) {\r\n\t\t\t\t\tthis.emit(\"complete\", time() - startTime);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t} while ((now = time()) - chunkStart < this.options.maxRunTime);\r\n\t\t\t\r\n\t\t\tif (now - startTime > this.options.timeout) {\r\n\t\t\t\tthis.emit(\"error\", new Error(`max execution time exceeded: ${now - startTime}, on ${this.root}`));\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tsetTimeout(next);\r\n\t\t};\r\n\t\t\t\r\n\t\tsetTimeout(next);\r\n\t}\r\n\tabort() {\r\n\t\tthis.aborted = true;\r\n\t}\r\n\t*generateRanges() {\r\n\t\tvar {validator} = this.options;\r\n\t\tvar filter = {\r\n\t\t\tacceptNode: function(node) {\r\n\t\t\t\tif (validator && !validator(node)) {\r\n\t\t\t\t\treturn NodeFilter.FILTER_REJECT;\r\n\t\t\t\t}\r\n\t\t\t\tif (INVALID_TAGS[node.localName]) {\r\n\t\t\t\t\treturn NodeFilter.FILTER_REJECT;\r\n\t\t\t\t}\r\n\t\t\t\tif (node.localName == \"wbr\") {\r\n\t\t\t\t\treturn NodeFilter.FILTER_ACCEPT;\r\n\t\t\t\t}\r\n\t\t\t\tif (node.nodeType == 3) {\r\n\t\t\t\t\treturn NodeFilter.FILTER_ACCEPT;\r\n\t\t\t\t}\r\n\t\t\t\treturn NodeFilter.FILTER_SKIP;\r\n\t\t\t}\r\n\t\t};\r\n\t\t// Generate linkified ranges.\r\n\t\tvar walker = document.createTreeWalker(\r\n\t\t\tthis.root,\r\n\t\t\tNodeFilter.SHOW_TEXT + NodeFilter.SHOW_ELEMENT,\r\n\t\t\tfilter\r\n\t\t), start, end, current, range;\r\n\r\n\t\tend = start = walker.nextNode();\r\n\t\tif (!start) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\trange = document.createRange();\r\n\t\trange.setStartBefore(start);\r\n\t\twhile ((current = walker.nextNode())) {\r\n\t\t\tif (end.nextSibling == current) {\r\n\t\t\t\tend = current;\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\trange.setEndAfter(end);\r\n\t\t\tyield range;\r\n\r\n\t\t\tend = start = current;\r\n\t\t\trange.setStartBefore(start);\r\n\t\t}\r\n\t\trange.setEndAfter(end);\r\n\t\tyield range;\r\n\t}\r\n\t*generateChunks() {\r\n\t\tvar {matcher} = this.options;\r\n\t\tfor (var range of this.generateRanges()) {\r\n\t\t\tvar frag = null,\r\n\t\t\t\tpos = null,\r\n\t\t\t\ttext = range.toString(),\r\n\t\t\t\ttextRange = null;\r\n\t\t\tfor (var result of matcher.match(text)) {\r\n\t\t\t\tif (!frag) {\r\n\t\t\t\t\tfrag = document.createDocumentFragment();\r\n\t\t\t\t\tpos = new Pos(range.startContainer, range.startOffset);\r\n\t\t\t\t\ttextRange = range.cloneRange();\r\n\t\t\t\t}\r\n\t\t\t\t// clone text\r\n\t\t\t\tpos.moveTo(result.start);\r\n\t\t\t\ttextRange.setEnd(pos.container, pos.offset);\r\n\t\t\t\tfrag.appendChild(cloneContents(textRange));\r\n\t\t\t\t\r\n\t\t\t\t// clone link\r\n\t\t\t\ttextRange.collapse();\r\n\t\t\t\tpos.moveTo(result.end);\r\n\t\t\t\ttextRange.setEnd(pos.container, pos.offset);\r\n\t\t\t\t\r\n\t\t\t\tvar content = cloneContents(textRange),\r\n\t\t\t\t\tlink = this.buildLink(result, content);\r\n\r\n\t\t\t\ttextRange.collapse();\r\n\r\n\t\t\t\tfrag.appendChild(link);\r\n\t\t\t\tthis.emit(\"link\", {link, range, result, content});\r\n\t\t\t}\r\n\t\t\tif (pos) {\r\n\t\t\t\tpos.moveTo(text.length);\r\n\t\t\t\ttextRange.setEnd(pos.container, pos.offset);\r\n\t\t\t\tfrag.appendChild(cloneContents(textRange));\r\n\t\t\t\t\r\n\t\t\t\trange.deleteContents();\r\n\t\t\t\trange.insertNode(frag);\r\n\t\t\t}\r\n\t\t\tyield;\r\n\t\t}\r\n\t}\r\n\tbuildLink(result, content) {\r\n\t\tvar {newTab, embedImage, noOpener} = this.options;\r\n\t\tvar link = document.createElement(\"a\");\r\n\t\tlink.href = result.url;\r\n\t\tlink.title = \"Linkify Plus Plus\";\r\n\t\tlink.className = \"linkifyplus\";\r\n\t\tif (newTab) {\r\n\t\t\tlink.target = \"_blank\";\r\n\t\t}\r\n\t\tif (noOpener) {\r\n\t\t\tlink.rel = \"noopener\";\r\n\t\t}\r\n\t\tvar child;\r\n\t\tif (embedImage && /^[^?#]+\\.(?:jpg|jpeg|png|apng|gif|svg|webp)(?:$|[?#])/i.test(result.url)) {\r\n\t\t\tchild = new Image;\r\n\t\t\tchild.src = result.url;\r\n\t\t\tchild.alt = result.text;\r\n\t\t} else {\r\n\t\t\tchild = content;\r\n\t\t}\r\n\t\tlink.appendChild(child);\r\n\t\treturn link;\r\n\t}\r\n}\r\n\r\nfunction linkify(...args) {\r\n\treturn new Promise((resolve, reject) => {\r\n\t\tvar linkifier = new Linkifier(...args);\r\n\t\tlinkifier.on(\"error\", reject);\r\n\t\tlinkifier.on(\"complete\", resolve);\r\n\t\tfor (var key of Object.keys(linkifier.options)) {\r\n\t\t\tif (key.startsWith(\"on\")) {\r\n\t\t\t\tlinkifier.on(key.slice(2), linkifier.options[key]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tlinkifier.start();\r\n\t});\r\n}\r\n\r\nmodule.exports = {\r\n\tINVALID_TAGS,\r\n\tLinkifier,\r\n\tlinkify\r\n};\r\n"],"names":["TLD_TABLE","regexEscape","text","replace","pathStrip","m","re","repl","s","path","end","length","suffix","slice","pathStripQuote","c","i","pos","endsWith","indexOf","pathStripBrace","left","right","match","str","RegExp","count","exec","index","isIP","inTLDS","domain","key","toLowerCase","hasOwnProperty","getInvalidLabel","parts","split","part","test","value","EventLite","_module_","exports","methods","on","type","func","getListeners","this","push","once","that","wrap","originalListener","off","call","apply","arguments","emit","listeners","arglen","forEach","zeroarg","onearg","args","Array","prototype","moreargs","mixin","target","listners","filter","ne","Object","keys","readonly","INVALID_TAGS","a","noscript","option","script","style","textarea","svg","canvas","button","select","template","meter","progress","math","time","Pos","[object Object]","container","offset","change","cont","childNodes","nodeType","LEN","nodeValue","nextSibling","add","cloneContents","range","startContainer","endContainer","document","createTextNode","toString","DEFAULT_OPTIONS","maxRunTime","timeout","newTab","noOpener","embedImage","Linkifier","Events","root","options","super","Node","assign","aborted","Date","now","startTime","chunks","generateChunks","next","Error","chunkStart","done","setTimeout","start","current","validator","acceptNode","node","localName","NodeFilter","FILTER_REJECT","FILTER_ACCEPT","FILTER_SKIP","walker","createTreeWalker","SHOW_TEXT","SHOW_ELEMENT","nextNode","createRange","setStartBefore","setEndAfter","matcher","generateRanges","frag","textRange","result","createDocumentFragment","startOffset","cloneRange","moveTo","setEnd","appendChild","collapse","content","link","buildLink","deleteContents","insertNode","child","createElement","href","url","title","className","rel","Image","src","alt","regex","unicode","customRules","standalone","boundaryLeft","boundaryRight","prefix","invalidSuffix","pattern","RE","join","mustache","buildRegex","urlLastIndex","mustacheLastIndex","mustacheMatch","mustacheRange","urlMatch","fuzzyIp","ignoreMustache","mail","lastIndex","custom","protocol","auth","port","matchMail","domainMatch","invalidLabel","Promise","resolve","reject","linkifier","startsWith"],"mappings":"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"}